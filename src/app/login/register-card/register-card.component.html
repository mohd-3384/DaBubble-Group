<main>
  <mat-card appearance="outlined">
    <mat-card-header>
      <img src="/public/images/arrow-back.svg" alt="arrow-back" class="back-arrow" (click)="back.emit()">
      <mat-card-title>Konto erstellen</mat-card-title>
      <mat-card-subtitle>Mit deinem Namen und deiner E-Mail-Adresse hast du dein neues
        DABubble-Konto.</mat-card-subtitle>
    </mat-card-header>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">

      <div class="input-container">
        <div class="span-input">
          <div class="name-input">
            <img src="./public/images/mail-icon.svg" alt="email icon">
            <input type="name" placeholder="Name und Nachname" formControlName="name">
          </div>
          @if (form.get('name')?.touched && form.get('name')?.invalid) {
          <span class="wrong-password">
            @if (form.get('name')?.errors?.['required']) {
            Bitte schreibe deinen Namen.
            }
            @else if (form.get('name')?.errors?.['minlength']) {
            Mindestens 3 Zeichen.
            }
            @else if (form.get('name')?.errors?.['pattern']) {
            Nur Buchstaben erlaubt.
            }
            @else if (form.get('name')?.errors?.['duplicate']) {
            Dieser Name ist bereits vergeben.
            }
          </span>}
        </div>
        <div class="span-input">
          <div class="email-input">
            <img src="./public/images/password-icon.svg" alt="password icon">
            <input type="email" placeholder="beispielname@email.com" formControlName="email">
          </div>
          @if (form.get('email')?.touched && form.get('email')?.invalid) {
          <span class="wrong-password">
            @if (form.get('email')?.errors?.['required']) {
            Bitte gib deine E-Mail-Adresse ein.
            }
            @else if (form.get('email')?.errors?.['email']) {
            Deine E-Mail-Adresse ist ungültig.
            }
          </span>}
        </div>
        <div class="span-input">
          <div class="password-input">
            <img src="./public/images/password-icon.svg" alt="password icon" class="password-icon">
            <input [type]="showPassword() ? 'text' : 'password'" placeholder="Passwort" formControlName="password">
            <button type="button" class="password-toggle" (click)="togglePassword()"
              [attr.aria-label]="showPassword() ? 'Passwort verbergen' : 'Passwort anzeigen'">
              <svg *ngIf="!showPassword()" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M12 5c5.5 0 9.5 5.1 9.5 7s-4 7-9.5 7S2.5 14 2.5 12 6.5 5 12 5zm0 2c-4 0-7 3.9-7 5s3 5 7 5 7-3.9 7-5-3-5-7-5zm0 2.5A2.5 2.5 0 1 1 9.5 12 2.5 2.5 0 0 1 12 9.5z" />
              </svg>
              <svg *ngIf="showPassword()" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M3.3 4.7 4.7 3.3l16 16-1.4 1.4-3-3A9.9 9.9 0 0 1 12 19c-5.5 0-9.5-5.1-9.5-7a9.6 9.6 0 0 1 4.1-5.9L3.3 4.7zM8 9.4a4 4 0 0 0 5.6 5.6l-1.5-1.5a2 2 0 0 1-2.6-2.6L8 9.4zm4-4.4c5.5 0 9.5 5.1 9.5 7a9.3 9.3 0 0 1-3 5.1l-1.5-1.5A7.9 7.9 0 0 0 19.5 12c0-1.1-3-5-7.5-5a7.7 7.7 0 0 0-2.6.4L7.9 5.9A9.9 9.9 0 0 1 12 5z" />
              </svg>
            </button>
          </div>
          @if (showPwErrors) {
          <span class="wrong-password">
            @if (!pwValue) { Bitte geben Sie ein Passwort ein. }
            @else {
            @if (pwTooShort) { Mindestens 6 Zeichen. }
            @if (pwMissingUpper) { Mindestens ein Großbuchstabe. }
            @if (pwMissingSpecial) { Mindestens ein Sonderzeichen (!&#64;#$&*). }
            }
          </span>}
        </div>
      </div>

      <div class="privacy-policy">
        <div class="checkbox-container">
          <input type="checkbox" id="terms" name="terms" formControlName="terms">
          <label for="terms">
            Ich stimme der <a routerLink="/privacy-policy">Datenschutzerklärung</a> zu.
          </label>
        </div>
      </div>
      @if (form.get('terms')?.touched && form.get('terms')?.invalid) {
      <span class="wrong-password">Du musst der Datenschutzerklärung zustimmen.</span>
      }
      @if (registrationError()) {
      <span class="wrong-password">{{ registrationError() }}</span>
      }

      <div class="button-container">
        <button class="button_1" type="submit" [disabled]="form.invalid">Weiter</button>
      </div>
    </form>
  </mat-card>
</main>
