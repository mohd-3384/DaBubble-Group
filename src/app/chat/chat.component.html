<!-- Kopfzeile des Chats -->
<header class="chat-header">
  <div class="title">
    <mat-icon>{{ kind === 'channel' ? 'tag' : 'person' }}</mat-icon>
    <h2>{{ kind === 'channel' ? ('# ' + name) : name }}</h2>
  </div>
</header>

<mat-divider></mat-divider>

<!-- Nachrichtenliste -->
<section class="messages">
  <article class="message" *ngFor="let m of messages">
    <div class="avatar">
      <img [src]="m.author.avatarUrl || '/public/images/avatars/avatar1.svg'" [alt]="m.author.name" />
    </div>

    <div class="bubble">
      <div class="meta">
        <span class="author">{{ m.author.name }}</span>
        <span class="dot">•</span>
        <time class="time">{{ m.createdAt | date:'HH:mm' }}</time>
      </div>

      <div class="text">{{ m.text }}</div>

      <div class="actions">
        <mat-chip-listbox *ngIf="m.reactions?.length" class="reactions" aria-label="Reactions">
          <mat-chip-option *ngFor="let rx of m.reactions" selected disableRipple>
            {{ rx.emoji }}&nbsp;<span>{{ rx.count }}</span>
          </mat-chip-option>
        </mat-chip-listbox>

        <span class="spacer"></span>

        <!-- „Antworten“ öffnet rechts den Thread (via ThreadState) -->
        <button mat-stroked-button color="primary" class="reply-btn" (click)="openThreadFromMessage(m)"
          matTooltip="Thread öffnen">
          Antworten
        </button>
      </div>
    </div>
  </article>
</section>